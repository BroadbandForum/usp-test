<!-- <h1 class="display-none" id="sec:authentication-and-access-control-test-cases">2 Authentication and Access Control Test Cases<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:authentication-and-access-control-test-cases" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h1> -->

<h2 id="sec:agent-does-not-accept-messages-from-its-own-endpoint-id">2.1 Agent does not accept messages from its own Endpoint ID<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:agent-does-not-accept-messages-from-its-own-endpoint-id" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h2>

<h3 id="sec:purpose-90">Purpose<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:purpose-90" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>The purpose of this test is to ensure the EUT does not respond to a USP message
when the <code>from_id</code> is the EUT endpoint ID.</p>

<h3 id="sec:functionality-tag-89">Functionality Tag<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:functionality-tag-89" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>Mandatory</p>

<h3 id="sec:test-setup-91">Test Setup<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-setup-91" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>Ensure that the EUT and test equipment have the necessary information to
send and receive USP Records to each other.</li>
</ol>

<h3 id="sec:test-steps">Test Steps<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-steps" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li><p>Send a message to the EUT with the following record structure:</p>

<pre><code filter="pbv" type="Record">    to_id: '&lt;EUT_ID&gt;'
    from_id: '&lt;EUT_ID&gt;'

    session_context {
        # ...
    }</code></pre></li>
</ol>

<h3 id="sec:test-metrics-90">Test Metrics<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-metrics-90" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>The EUT does not respond to the message.</li>
</ol>

<h2 id="sec:agent-rejects-messages-that-do-not-contain-its-to_id-in-the-usp-record">2.2 Agent rejects messages that do not contain its to_id in the USP Record<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:agent-rejects-messages-that-do-not-contain-its-to_id-in-the-usp-record" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h2>

<h3 id="sec:purpose-91">Purpose<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:purpose-91" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>The purpose of this test is to ensure the EUT does not respond to a USP message
when the USP record doesn’t contain a the EUT <code>to_id</code>.</p>

<h3 id="sec:functionality-tags-2">Functionality Tags<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:functionality-tags-2" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>Mandatory</p>

<h3 id="sec:test-setup-92">Test Setup<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-setup-92" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>Ensure that the EUT and test equipment have the necessary information to
send and receive USP Records to each other.</li>
</ol>

<h3 id="sec:test-steps-1">Test Steps<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-steps-1" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li><p>Send a message to the EUT with the following record structure:</p>

<pre><code filter="pbv" type="Record">    to_id: '&lt;invalid ID&gt;'
    from_id: '&lt;EUT_ID&gt;'

    # ...
</code></pre></li>
</ol>

<h3 id="sec:test-metrics-91">Test Metrics<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-metrics-91" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>The EUT does not respond to the USP message.</li>
</ol>

<h2 id="sec:agent-does-not-process-messages-without-s-certificate-information---deprecated">2.3 Agent does not process messages without ’s certificate information - DEPRECATED<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:agent-does-not-process-messages-without-s-certificate-information---deprecated" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h2>

<h3 id="sec:purpose-92">Purpose<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:purpose-92" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>The purpose of this test is to ensure that the EUT doesn’t process a USP message
when the EUT does not possess the Controller’s certificate information.</p>

<h3 id="sec:functionality-tags-3">Functionality Tags<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:functionality-tags-3" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>Deprecated</p>

<h3 id="sec:test-setup-93">Test Setup<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-setup-93" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>Ensure that the EUT and test equipment have the necessary information to
send and receive USP Records to each other.</li>
<li>Simulate a second Controller whose credentials are signed by an untrusted
certificate authority.</li>
<li>Ensure that the UntrustedRole feature is either unsupported or disabled in
the EUT.</li>
</ol>

<h3 id="sec:test-procedure-90">Test Procedure<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-procedure-90" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li><p>Send a Get message from the second simulated Controller to the EUT with the following structure:</p>

<pre><code filter="pbv" type="Msg">header {
    msg_id: '&lt;msg_id&gt;'
    msg_type: GET
}

body {
    request {
        get {
            param_paths: 'Device.LocalAgent.'
        }
    }
}</code></pre></li>
</ol>

<h3 id="sec:test-metrics-92">Test Metrics<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-metrics-92" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>Ensure the EUT does not respond to the Get message.</li>
</ol>

<h2 id="sec:agent-rejects-messages-from-endpoint-ids-that-are-not-in-subjectaltname---deprecated">2.4 Agent rejects messages from Endpoint IDs that are not in subjectAltName - DEPRECATED<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:agent-rejects-messages-from-endpoint-ids-that-are-not-in-subjectaltname---deprecated" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h2>

<h3 id="sec:purpose-93">Purpose<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:purpose-93" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>The purpose of this test is to ensure that the EUT rejects a message from an
Endpoint ID that doesn’t match the subjectAltName in the provided certificate.</p>

<h3 id="sec:functionality-tags-4">Functionality Tags<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:functionality-tags-4" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>Deprecated</p>

<h3 id="sec:test-setup-94">Test Setup<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-setup-94" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>Ensure that the EUT and test equipment have the necessary information to
send and receive USP Records to each other.</li>
</ol>

<h3 id="sec:test-procedure-91">Test Procedure<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-procedure-91" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>Send a Get message to the EUT using a certificate with a
subjectAltName that does not match the Controller’s Endpoint ID.</li>
</ol>

<h3 id="sec:test-metrics-93">Test Metrics<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-metrics-93" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>The EUT does not respond to the Get message.</li>
</ol>

<h2 id="sec:agent-use-of-self-signed-certificates---deprecated">2.5 Agent use of self-signed certificates - DEPRECATED<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:agent-use-of-self-signed-certificates---deprecated" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h2>

<h3 id="sec:purpose-94">Purpose<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:purpose-94" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>The purpose of this test is to ensure the EUT can handle self-signed certificates.</p>

<h3 id="sec:functionality-tags-5">Functionality Tags<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:functionality-tags-5" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>Deprecated</p>

<h3 id="sec:test-setup-95">Test Setup<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-setup-95" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>Ensure that the EUT and test equipment have the necessary information to
send and receive USP Records to each other.</li>
<li>Ensure the is configured to use a self-signed certificate and Endpoint ID
that the EUT has not seen.</li>
</ol>

<h3 id="sec:test-procedure-92">Test Procedure<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-procedure-92" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li><p>Send a Get message to the EUT using a self-signed cert with the following
structure:</p>

<pre><code filter="pbv" type="Msg">header {
    msg_id: '&lt;msg_id&gt;'
    msg_type: GET
}
body {
    request {
        get {
            param_paths: 'Device.LocalAgent.'
        }
    }
}</code></pre></li>
</ol>

<h3 id="sec:test-metrics-94">Test Metrics<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-metrics-94" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>The EUT responds to the Get with a GetResponse containing a
&lsquo;Device.LocalAgent.ControllerTrust.{i}.Alias&rsquo; parameter.</li>
</ol>

<h2 id="sec:connecting-without-absolute-time">2.6 Connecting without absolute time<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:connecting-without-absolute-time" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h2>

<h3 id="sec:purpose-95">Purpose<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:purpose-95" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>The purpose of this test is to ensure the EUT can communicate with a Controller
if it cannot obtain an absolute time.</p>

<h3 id="sec:functionality-tags-6">Functionality Tags<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:functionality-tags-6" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>Conditional Mandatory (Supports USP Session Context)</p>

<h3 id="sec:test-setup-96">Test Setup<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-setup-96" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>The EUT is booted into a test environment where it cannot resolve absolute time.</li>
<li>Ensure that the EUT and test equipment have the necessary information to send
and receive USP Records to each other.</li>
<li>Ensure the Controller is configured to use an expired certificate.</li>
</ol>

<h3 id="sec:test-procedure-93">Test Procedure<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-procedure-93" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li><p>Send a Get message to the EUT with the following structure:</p>

<pre><code filter="pbv" type="Msg">header{
    msg_id: '&lt;msg_id&gt;'
    msg_type: GET
}
body {
    request {
        get {
            param_paths: 'Device.LocalAgent.'
        }
    }
}</code></pre></li>
</ol>

<h3 id="sec:test-metrics-95">Test Metrics<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-metrics-95" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>The EUT responds to the Get message with a GetResponse, ignoring the expired
dates on the certificate.</li>
</ol>

<h2 id="sec:agent-ignores-unsigned-or-invalid-record-signatures">2.7 Agent ignores unsigned or invalid Record signatures<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:agent-ignores-unsigned-or-invalid-record-signatures" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h2>

<h3 id="sec:purpose-96">Purpose<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:purpose-96" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>The purpose of this test is to ensure the EUT will ignore a USP record when
the signature field is invalid.</p>

<h3 id="sec:functionality-tags-7">Functionality Tags<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:functionality-tags-7" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>Conditional Mandatory (Supports USP Session Context)</p>

<h3 id="sec:test-setup-97">Test Setup<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-setup-97" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>Ensure that the EUT and test equipment have the necessary information to send
and receive USP Records to each other.</li>
</ol>

<h3 id="sec:test-procedure-94">Test Procedure<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-procedure-94" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>Send a Get message to the EUT with an invalid signature value.</li>
</ol>

<h3 id="sec:test-metrics-96">Test Metrics<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-metrics-96" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>The EUT does not respond to the Get message.</li>
</ol>

<h2 id="sec:agent-ignores-invalid-tls-certificate">2.8 Agent ignores invalid TLS certificate<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:agent-ignores-invalid-tls-certificate" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h2>

<h3 id="sec:purpose-97">Purpose<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:purpose-97" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>The purpose of this test is to ensure the EUT rejects TLS connections when
an Endpoint’s TLS certificate is invalid.</p>

<h3 id="sec:functionality-tags-8">Functionality Tags<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:functionality-tags-8" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>Conditional Mandatory (Supports USP Session Context)</p>

<h3 id="sec:test-setup-98">Test Setup<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-setup-98" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>Ensure that the EUT and test equipment have the necessary information to send
and receive USP Records to each other.</li>
<li>Ensure that the EUT has obtained an absolute time reference.</li>
</ol>

<h3 id="sec:test-procedure-95">Test Procedure<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-procedure-95" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>Send a Get message to the EUT with an expired TLS certificate.</li>
</ol>

<h3 id="sec:test-metrics-97">Test Metrics<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-metrics-97" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>The EUT doesn’t respond to the Get message.</li>
</ol>

<h2 id="sec:use-of-the-untrusted-role">2.9 Use of the Untrusted role<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:use-of-the-untrusted-role" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h2>

<h3 id="sec:purpose-98">Purpose<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:purpose-98" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>The purpose of this test is to ensure the EUT correctly assigns new
a Role of Untrusted.</p>

<h3 id="sec:functionality-tags-9">Functionality Tags<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:functionality-tags-9" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>Conditional Mandatory (supports the ControllerTrust:1 profile)</p>

<h3 id="sec:test-setup-99">Test Setup<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-setup-99" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>Ensure that the EUT and test equipment have the necessary information to send
and receive USP Records to each other.</li>
</ol>

<h3 id="sec:test-procedure-96">Test Procedure<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-procedure-96" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li><p>Using a secondary Controller, connect to the EUT and send an Get message.</p></li>
<li><p>Using the primary trusted Controller send a Get message to the EUT with the
following structure:</p>

<pre><code filter="pbv" type="Msg">header {
    msg_id: '&lt;msg_id&gt;'
    msg_type: GET
}
body {
    request {
        get {
            param_paths: 'Device.LocalAgent.Controller.'
        }
    }
}</code></pre></li>
</ol>

<h3 id="sec:test-metrics-98">Test Metrics<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-metrics-98" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>Ensure the <code>Device.LocalAgent.Controller.&lt;secondary Controller instance&gt;.AssignedRole</code>
matches the value of <code>Device.LocalAgent.ControllerTrust.UntrustedRole</code>.</li>
</ol>

<h2 id="sec:adding-a-role">2.10 Adding a Role<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:adding-a-role" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h2>

<h3 id="sec:purpose-99">Purpose<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:purpose-99" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>The purpose of this test is to ensure that the Add message can be used to add
new Roles to the EUT data model.</p>

<h3 id="sec:functionality-tags-10">Functionality Tags<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:functionality-tags-10" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>Conditional Mandatory (supports the ControllerTrust:1 profile)</p>

<h3 id="sec:test-setup-100">Test Setup<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-setup-100" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>Ensure that the EUT and test equipment have the necessary information to send
and receive USP Records to each other.</li>
</ol>

<h3 id="sec:test-procedure-97">Test Procedure<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-procedure-97" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li><p>Send a Add message to the EUT with the following structure:</p>

<pre><code filter="pbv" type="Msg">header {
    msg_id: '&lt;msg_id&gt;'
    msg_type: ADD
}
body {
    request {
        add {
            allow_partial: false
            create_objs {
                obj_path: 'Device.LocalAgent.ControllerTrust.Role.'
                param_settings {
                    param: 'Enable'
                    value: 'true'
                }
                param_settings {
                    param: 'Name'
                    value: 'Trusted'
                }
            }
        }
    }
}</code></pre></li>
</ol>

<h3 id="sec:test-metrics-99">Test Metrics<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-metrics-99" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>The EUT correctly sent an AddResponse with a new Role instance.</li>
</ol>

<h2 id="sec:permissions---object-creation-allowed">2.11 Permissions - Object Creation Allowed<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:permissions---object-creation-allowed" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h2>

<h3 id="sec:purpose-100">Purpose<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:purpose-100" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>The purpose of this test is to ensure the EUT adheres to permissions set to
allow the creation of a particular object.</p>

<h3 id="sec:functionality-tags-11">Functionality Tags<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:functionality-tags-11" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>Conditional Mandatory (supports the ControllerTrust:1 profile with at least one role that allows object creation, or supports writable parameters in Device.LocalAgent.ControllerTrust.{i}.Role.{i}.)</p>

<h3 id="sec:test-setup-101">Test Setup<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-setup-101" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>Ensure that the EUT and test equipment have the necessary information to send
and receive USP Records to each other.</li>
<li>Ensure the Controller used for testing has an assigned Role that is writable.</li>
</ol>

<h3 id="sec:test-procedure-98">Test Procedure<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-procedure-98" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li><p>Send an Add message to the EUT with the following structure:</p>

<pre><code filter="pbv" type="Msg">header {
    msg_id: '&lt;msg_id&gt;'
    msg_type: ADD
}
body {
    request {
        add {
            allow_partial: false
            create_objs {
                obj_path: 'Device.LocalAgent.ControllerTrust.Role.&lt;Controller Role instance&gt;.Permission.'
                param_settings {
                        param: 'Enable'
                        value: 'true'
                    }
                param_settings {
                        param: 'Targets'
                        value: 'Device.LocalAgent.Subscription.'
                    }
                param_settings {
                        param: 'Obj'
                        value: 'rw--'
                    }
            }
        }
    }
}</code></pre></li>
<li><p>Send an Add message to the EUT with the following structure:</p>

<pre><code filter="pbv" type="Msg">header {
    msg_id: '&lt;msg_id&gt;'
    msg_type: ADD
}
body {
    request {
        add {
            allow_partial: false
            create_objs {
                obj_path: 'Device.LocalAgent.Subscription.'
            }
        }
    }
}</code></pre></li>
</ol>

<h3 id="sec:test-metrics-100">Test Metrics<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-metrics-100" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>The EUT sends an AddResponse with a oper_success element containing a
new Device.LocalAgent.ControllerTrust.Role.{i}.Permission. object in step 1.</li>
<li>The EUT sends an AddResponse with a oper_success element containing a
new Device.LocalAgent.Subscription. object in step 2.</li>
</ol>

<h2 id="sec:permissions---object-creation-not-allowed">2.12 Permissions - Object Creation Not Allowed<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:permissions---object-creation-not-allowed" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h2>

<h3 id="sec:purpose-101">Purpose<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:purpose-101" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>The purpose of this test is to ensure the EUT adheres to permissions set to
restrict the creation of a particular object.</p>

<h3 id="sec:functionality-tags-12">Functionality Tags<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:functionality-tags-12" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>Conditional Mandatory (supports the ControllerTrust:1 profile with at least one role that allows object creation, or supports writable parameters in Device.LocalAgent.ControllerTrust.{i}.Role.{i}.)</p>

<h3 id="sec:test-setup-102">Test Setup<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-setup-102" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>Ensure that the EUT and test equipment have the necessary information to send
and receive USP Records to each other.</li>
<li>Ensure the Controller used for testing has an assigned Role that is writable.</li>
</ol>

<h3 id="sec:test-procedure-99">Test Procedure<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-procedure-99" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>Send an Add message to the EUT with the following structure:</li>
</ol>

<pre><code filter="pbv" type="Msg">header {
    msg_id: '&lt;msg_id&gt;'
    msg_type: ADD
}
body {
    request {
        add {
            allow_partial: false
            create_objs {
                obj_path: 'Device.LocalAgent.ControllerTrust.Role.&lt;Controller Role instance&gt;.Permission.'
                param_settings {
                        param: 'Enable'
                        value: 'true'
                    }
                param_settings {
                        param: 'Targets'
                        value: 'Device.LocalAgent.Subscription.'
                    }
                param_settings {
                        param: 'Obj'
                        value: 'r---'
                    }
            }
        }
    }
}</code></pre>

<ol>
<li>Send an Add message to the EUT with the following structure:</li>
</ol>

<pre><code filter="pbv" type="Msg">header {
    msg_id: '&lt;msg_id&gt;'
    msg_type: ADD
}
body {
    request {
        add {
            allow_partial: false
            create_objs {
                obj_path: 'Device.LocalAgent.Subscription.'
            }
        }
    }
}</code></pre>

<h3 id="sec:test-metrics-101">Test Metrics<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-metrics-101" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>The EUT sends an AddResponse with a oper_success element containing a
new Device.LocalAgent.ControllerTrust.Role.{i}.Permission. object in step 1.</li>
<li>The EUT sends an Error containing type &lsquo;7006&rsquo; - Permission Denied.</li>
</ol>

<h2 id="sec:permissions---object-deletion-allowed">2.13 Permissions - Object Deletion Allowed<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:permissions---object-deletion-allowed" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h2>

<h3 id="sec:purpose-102">Purpose<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:purpose-102" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>The purpose of this test is to ensure the EUT adheres to permissions set to
allow the deletion of a particular object.</p>

<h3 id="sec:functionality-tags-13">Functionality Tags<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:functionality-tags-13" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>Conditional Mandatory (supports the ControllerTrust:1 profile with at least one role that allows object creation, or supports writable parameters in Device.LocalAgent.ControllerTrust.{i}.Role.{i}.)</p>

<h3 id="sec:test-setup-103">Test Setup<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-setup-103" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>Ensure that the EUT and test equipment have the necessary information to send
and receive USP Records to each other.</li>
<li>Ensure the Controller used for testing has an assigned Role that is writable.</li>
<li>Ensure there is one or more Subscription object that can be deleted.</li>
</ol>

<h3 id="sec:test-procedure-100">Test Procedure<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-procedure-100" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li><p>Send an Add message to the EUT with the following structure:</p>

<pre><code filter="pbv" type="Msg">header {
    msg_id: '&lt;msg_id&gt;'
    msg_type: ADD
}
body {
    request {
        add {
            allow_partial: false
            create_objs {
                obj_path: 'Device.LocalAgent.ControllerTrust.Role.&lt;Controller Role instance&gt;.Permission.'
                param_settings {
                        param: 'Enable'
                        value: 'true'
                    }
                param_settings {
                        param: 'Targets'
                        value: 'Device.LocalAgent.Subscription.'
                    }
                param_settings {
                        param: 'InstantiatedObj'
                        value: 'rw--'
                    }
            }
        }
    }
}</code></pre></li>
<li><p>Send an Delete message to the EUT with the following structure:</p>

<pre><code filter="pbv" type="Msg">header {
    msg_id: '&lt;msg_id&gt;'
    msg_type: DELETE
}
body {
    request {
        delete {
            allow_partial: false
            obj_paths: 'Device.LocalAgent.Subscription.&lt;subscription to delete&gt;'
        }
    }
}</code></pre></li>
</ol>

<h3 id="sec:test-metrics-102">Test Metrics<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-metrics-102" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>The EUT sends an AddResponse with a <code>oper_success</code> element containing a
new Device.LocalAgent.ControllerTrust.Role.{i}.Permission. object in step 1.</li>
<li>The EUT sends an DeleteResponse with a <code>oper_success</code> element containing the
Device.LocalAgent.Subscription. object in step 2.</li>
</ol>

<h2 id="sec:permissions---object-deletion-not-allowed">2.14 Permissions - Object Deletion Not Allowed<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:permissions---object-deletion-not-allowed" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h2>

<h3 id="sec:purpose-103">Purpose<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:purpose-103" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>The purpose of this test is to ensure the EUT adheres to permissions set to
restrict the deletion of a particular object.</p>

<h3 id="sec:functionality-tags-14">Functionality Tags<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:functionality-tags-14" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>Conditional Mandatory (supports the ControllerTrust:1 profile with at least one role that allows object creation, or supports writable parameters in Device.LocalAgent.ControllerTrust.{i}.Role.{i}.)</p>

<h3 id="sec:test-setup-104">Test Setup<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-setup-104" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>Ensure that the EUT and test equipment have the necessary information to send
and receive USP Records to each other.</li>
<li>Ensure the Controller used for testing has an assigned Role that is writable.</li>
<li>Ensure there is one or more Subscription object that can be deleted.</li>
</ol>

<h3 id="sec:test-procedure-101">Test Procedure<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-procedure-101" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li><p>Send an Add message to the EUT with the following structure:</p>

<pre><code filter="pbv" type="Msg">header {
    msg_id: '&lt;msg_id&gt;'
    msg_type: ADD
}
body {
    request {
        add {
            allow_partial: false
            create_objs {
                obj_path: 'Device.LocalAgent.ControllerTrust.Role.&lt;Controller Role instance&gt;.Permission.'
                param_settings {
                        param: 'Enable'
                        value: 'true'
                    }
                param_settings {
                        param: 'Targets'
                        value: 'Device.LocalAgent.Subscription.'
                    }
                param_settings {
                        param: 'InstantiatedObj'
                        value: 'r---'
                    }
            }
        }
    }
}</code></pre></li>
<li><p>Send an Delete message to the EUT with the following structure:</p>

<pre><code filter="pbv" type="Msg">header {
    msg_id: '&lt;msg_id&gt;'
    msg_type: DELETE
}
body {
    request {
        delete {
            allow_partial: false
            obj_paths: 'Device.LocalAgent.Subscription.&lt;subscription to delete&gt;'
        }
    }
}</code></pre></li>
</ol>

<h3 id="sec:test-metrics-103">Test Metrics<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-metrics-103" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>The EUT sends an AddResponse with a <code>oper_success</code> element containing a
new Device.LocalAgent.ControllerTrust.Role.{i}.Permission. object in step 1.</li>
<li>The EUT sends an Error containing type &lsquo;7006&rsquo; - Permission Denied.</li>
</ol>

<h2 id="sec:permissions---parameter-update-allowed">2.15 Permissions - Parameter Update Allowed<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:permissions---parameter-update-allowed" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h2>

<h3 id="sec:purpose-104">Purpose<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:purpose-104" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>The purpose of this test is to ensure the EUT adheres to permissions set to
allow the update of a particular object.</p>

<h3 id="sec:functionality-tags-15">Functionality Tags<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:functionality-tags-15" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>Conditional Mandatory (supports the ControllerTrust:1 profile with at least one role that allows object creation, or supports writable parameters in Device.LocalAgent.ControllerTrust.{i}.Role.{i}.)</p>

<h3 id="sec:test-setup-105">Test Setup<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-setup-105" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>Ensure that the EUT and test equipment have the necessary information to send
and receive USP Records to each other.</li>
<li>Ensure the Controller used for testing has an assigned Role that is writable.</li>
<li>Ensure there is one or more Subscription object that can be edited.</li>
</ol>

<h3 id="sec:test-procedure-102">Test Procedure<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-procedure-102" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li><p>Send an Add message to the EUT with the following structure:</p>

<pre><code filter="pbv" type="Msg">header {
    msg_id: '&lt;msg_id&gt;'
    msg_type: ADD
}
body {
    request {
        add {
            allow_partial: false
            create_objs {
                obj_path: 'Device.LocalAgent.ControllerTrust.Role.&lt;Controller Role instance&gt;.Permission.'
                param_settings {
                        param: 'Enable'
                        value: 'true'
                    }
                param_settings {
                        param: 'Targets'
                        value: 'Device.LocalAgent.Subscription.&lt;instance that can be edited&gt;.'
                    }
                param_settings {
                        param: 'Param'
                        value: 'rw--'
                    }
            }
        }
    }
}</code></pre></li>
<li><p>Send a Set message to the EUT with the following structure:</p>

<pre><code filter="pbv" type="Msg">header {
    msg_id: '&lt;msg_id&gt;'
    msg_type: SET
}
body {
    request {
        set {
            allow_partial: false
            update_objs {
                    obj_path: 'Device.LocalAgent.Subscription.&lt;instance that can be edited&gt;.'
                    param_settings {
                            param: 'Enable'
                            value: '&lt;negation of previous value&gt;'
                            required: true
                        }
                }
        }
    }
}</code></pre></li>
</ol>

<h3 id="sec:test-metrics-104">Test Metrics<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-metrics-104" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>The EUT sends an AddResponse with a <code>oper_success</code> element containing a
new Device.LocalAgent.ControllerTrust.Role.{i}.Permission. object in step 1.</li>
<li>The EUT sends a SetResponse with a <code>oper_success</code> element containing
Device.LocalAgent.Subscription.{i}.Enable in step 2.</li>
</ol>

<h2 id="sec:permissions---parameter-update-not-allowed">2.16 Permissions - Parameter Update Not Allowed<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:permissions---parameter-update-not-allowed" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h2>

<h3 id="sec:purpose-105">Purpose<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:purpose-105" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>The purpose of this test is to ensure the EUT adheres to permissions set to
restrict the update of a particular object.</p>

<h3 id="sec:functionality-tags-16">Functionality Tags<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:functionality-tags-16" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>Conditional Mandatory (supports the ControllerTrust:1 profile with at least one role that allows object creation, or supports writable parameters in Device.LocalAgent.ControllerTrust.{i}.Role.{i}.)</p>

<h3 id="sec:test-setup-106">Test Setup<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-setup-106" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>Ensure that the EUT and test equipment have the necessary information to send
and receive USP Records to each other.</li>
<li>Ensure the Controller used for testing has an assigned Role that is writable.</li>
<li>Ensure there is one or more Subscription object that can be edited.</li>
</ol>

<h3 id="sec:test-steps-2">Test Steps<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-steps-2" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li><p>Send an Add message to the EUT with the following structure:</p>

<pre><code filter="pbv" type="Msg">header {
    msg_id: '&lt;msg_id&gt;'
    msg_type: ADD
}
body {
    request {
        add {
            allow_partial: false
            create_objs {
                obj_path: 'Device.LocalAgent.ControllerTrust.Role.&lt;Controller Role instance&gt;.Permission.'
                param_settings {
                        param: 'Enable'
                        value: 'true'
                    }
                param_settings {
                        param: 'Targets'
                        value: 'Device.LocalAgent.Subscription.&lt;instance that can be edited&gt;.'
                    }
                param_settings {
                        param: 'Param'
                        value: 'r---'
                    }
            }
        }
    }
}</code></pre></li>
<li><p>Send a Set message to the EUT with the following structure:</p>

<pre><code filter="pbv" type="Msg">header {
    msg_id: '&lt;msg_id&gt;'
    msg_type: SET
}
body {
    request {
        set {
            allow_partial: false
            update_objs {
                    obj_path: 'Device.LocalAgent.Subscription.&lt;instance that can be edited&gt;.'
                    param_settings {
                            param: 'Enable'
                            value: '&lt;negation of previous value&gt;'
                            required: true
                        }
                }
        }
    }
}</code></pre></li>
</ol>

<h3 id="sec:test-metrics-105">Test Metrics<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-metrics-105" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>The EUT sends an AddResponse with a <code>oper_success</code> element containing a
new Device.LocalAgent.ControllerTrust.Role.{i}.Permission. object in step 1.</li>
<li>The EUT sends an Error containing type &lsquo;7006&rsquo; - Permission Denied.</li>
</ol>

<h2 id="sec:permissions---operation-allowed">2.17 Permissions - Operation Allowed<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:permissions---operation-allowed" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h2>

<h3 id="sec:purpose-106">Purpose<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:purpose-106" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>The purpose of this test is to ensure the EUT adheres to permissions set to
allow the invocation of commands on a particular object.</p>

<h3 id="sec:functionality-tags-17">Functionality Tags<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:functionality-tags-17" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>Conditional Mandatory (supports the ControllerTrust:1 profile with at least one role that allows object creation, or supports writable parameters in Device.LocalAgent.ControllerTrust.{i}.Role.{i}.)</p>

<h3 id="sec:test-setup-107">Test Setup<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-setup-107" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>Ensure that the EUT and test equipment have the necessary information to send
and receive USP Records to each other.</li>
<li>Ensure the Controller used for testing has an assigned Role that is writable.</li>
</ol>

<h3 id="sec:test-steps-3">Test Steps<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-steps-3" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li><p>Send an Add message to the EUT with the following structure:</p>

<pre><code filter="pbv" type="Msg">header {
    msg_id: '&lt;msg_id&gt;'
    msg_type: ADD
}
body {
    request {
        add {
            allow_partial: false
            create_objs {
                obj_path: 'Device.LocalAgent.ControllerTrust.Role.&lt;Controller Role instance&gt;.Permission.'
                param_settings {
                        param: 'Enable'
                        value: 'true'
                    }
                param_settings {
                        param: 'Targets'
                        value: 'Device.Reboot()'
                    }
                param_settings {
                        param: 'CommandEvent'
                        value: 'r-x-'
                    }
            }
        }
    }
}</code></pre></li>
<li><p>Send an Operate message to the EUT with the following structure:</p>

<pre><code filter="pbv" type="Msg">header {
    msg_id: '&lt;msg_id&gt;'
    msg_type: OPERATE
}
body {
    request {
        operate {
            command: 'Device.Reboot()'
            send_resp: true
        }
    }
}</code></pre></li>
</ol>

<h3 id="sec:test-metrics-106">Test Metrics<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-metrics-106" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>The EUT sends an AddResponse with a <code>oper_success</code> element containing a
new Device.LocalAgent.ControllerTrust.Role.{i}.Permission. object in step 1.</li>
<li>The EUT sends an OperateResponse with a <code>req_output_args</code> element in step 2.</li>
</ol>

<h2 id="sec:permissions---operation-not-allowed">2.18 Permissions - Operation Not Allowed<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:permissions---operation-not-allowed" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h2>

<h3 id="sec:purpose-107">Purpose<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:purpose-107" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>The purpose of this test is to ensure the EUT adheres to permissions set to
restrict the invocation of commands on a particular object.</p>

<h3 id="sec:functionality-tags-18">Functionality Tags<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:functionality-tags-18" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>Conditional Mandatory (supports the ControllerTrust:1 profile with at least one role that allows object creation, or supports writable parameters in Device.LocalAgent.ControllerTrust.{i}.Role.{i}.)</p>

<h3 id="sec:test-setup-108">Test Setup<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-setup-108" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>Ensure that the EUT and test equipment have the necessary information to send
and receive USP Records to each other.</li>
<li>Ensure the Controller used for testing has an assigned Role that is writable.</li>
</ol>

<h3 id="sec:test-steps-4">Test Steps<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-steps-4" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li><p>Send an Add message to the EUT with the following structure:</p>

<pre><code filter="pbv" type="Msg">header {
    msg_id: '&lt;msg_id&gt;'
    msg_type: ADD
}
body {
    request {
        add {
            allow_partial: false
            create_objs {
                obj_path: 'Device.LocalAgent.ControllerTrust.Role.&lt;Controller Role instance&gt;.Permission.'
                param_settings {
                        param: 'Enable'
                        value: 'true'
                    }
                param_settings {
                        param: 'Targets'
                        value: 'Device.Reboot()'
                    }
                param_settings {
                        param: 'CommandEvent'
                        value: 'r---'
                    }
            }
        }
    }
}</code></pre></li>
<li><p>Send a Set message to the EUT with the following structure:</p>

<pre><code filter="pbv" type="Msg">header {
    msg_id: '&lt;msg_id&gt;'
    msg_type: OPERATE
}
body {
    request {
        operate {
            command: 'Device.Reboot()'
        }
    }
}</code></pre></li>
</ol>

<h3 id="sec:test-metrics-107">Test Metrics<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-metrics-107" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>The EUT sends an AddResponse with a <code>oper_success</code> element containing a
new Device.LocalAgent.ControllerTrust.Role.{i}.Permission. object in step 1.</li>
<li>The EUT sends an Error message containing an appropriate error code.</li>
</ol>

<h2 id="sec:permissions---value-change-notification-allowed-on-parameter">2.19 Permissions - Value Change Notification Allowed on Parameter<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:permissions---value-change-notification-allowed-on-parameter" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h2>

<h3 id="sec:purpose-108">Purpose<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:purpose-108" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>The purpose of this test is to ensure the EUT adheres to permissions set to
allow a Controller to subscribe to the ValueChange notification of a particular
parameter.</p>

<h3 id="sec:functionality-tags-19">Functionality Tags<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:functionality-tags-19" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>Conditional Mandatory (supports the ControllerTrust:1 profile with at least one role that allows object creation, or supports writable parameters in Device.LocalAgent.ControllerTrust.{i}.Role.{i}.)</p>

<h3 id="sec:test-setup-109">Test Setup<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-setup-109" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>Ensure that the EUT and test equipment have the necessary information to send
and receive USP Records to each other.</li>
<li>Ensure the Controller used for testing has an assigned Role that is writable.</li>
</ol>

<h3 id="sec:test-steps-5">Test Steps<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-steps-5" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li><p>Send an Add message to the EUT with the following structure:</p>

<pre><code filter="pbv" type="Msg">header {
    msg_id: '&lt;msg_id&gt;'
    msg_type: ADD
}
body {
    request {
        add {
            allow_partial: false
            create_objs {
                obj_path: 'Device.LocalAgent.ControllerTrust.Role.&lt;Controller Role instance&gt;.Permission.'
                param_settings {
                        param: 'Enable'
                        value: 'true'
                    }
                param_settings {
                        param: 'Targets'
                        value: 'Device.LocalAgent.Controller.&lt;Controller instance id&gt;.PeriodicNotifInterval'
                    }
                param_settings {
                        param: 'Param'
                        value: 'rw-n'
                    }
            }
        }
    }
}</code></pre></li>
<li><p>Send an Add message to the EUT with the following structure:</p>

<pre><code filter="pbv" type="Msg">header {
    msg_id: '&lt;msg_id&gt;'
    msg_type: ADD
}
body {
    request {
        add {
            allow_partial: false
            create_objs {
                obj_path: 'Device.LocalAgent.Subscription.'
                param_settings {
                        param: 'Enable'
                        value: 'true'
                    }
                param_settings {
                        param: 'NotifType'
                        value: 'ValueChange'
                    }
                param_settings {
                        param: 'ReferenceList'
                        value: 'Device.LocalAgent.Controller.&lt;Controller instance id&gt;.PeriodicNotifInterval'
                    }
            }
        }
    }
  }</code></pre></li>
<li><p>Send a Set message to the EUT, setting
Device.LocalAgent.Controller.&lt;Controller instance id&gt;.PeriodicNotifInterval to a new value.</p></li>
<li><p>Wait for a Notification from the EUT.</p></li>
</ol>

<h3 id="sec:test-metrics-108">Test Metrics<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-metrics-108" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>The EUT sends an AddResponse with an <code>oper_success</code> element containing a
new Device.LocalAgent.ControllerTrust.Role.{i}.Permission. object in step 1.</li>
<li>The EUT sends an AddResponse with an <code>oper_success</code> element containing a
new Device.LocalAgent.Subscription. object in step 2.</li>
<li>The EUT sends a SetResponse with an <code>oper_success</code> element with the path
&lsquo;Device.LocalAgent.Controller.&lt;Controller instance id&gt;.PeriodicNotifInterval&rsquo;.</li>
<li>The EUT sends a Notify message with a <code>value_change</code> element pointing to
&lsquo;Device.LocalAgent.Controller.&lt;Controller instance&gt;.PeriodicNotifInterval&rsquo;.</li>
</ol>

<h2 id="sec:permissions---value-change-notification-not-allowed-on-parameter">2.20 Permissions - Value Change Notification Not Allowed on Parameter<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:permissions---value-change-notification-not-allowed-on-parameter" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h2>

<h3 id="sec:purpose-109">Purpose<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:purpose-109" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>The purpose of this test is to ensure the EUT adheres to permissions set to
restrict a Controller from subscribing to the ValueChange notification of a particular
parameter.</p>

<h3 id="sec:functionality-tags-20">Functionality Tags<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:functionality-tags-20" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>Conditional Mandatory (supports the ControllerTrust:1 profile with at least one role that allows object creation, or supports writable parameters in Device.LocalAgent.ControllerTrust.{i}.Role.{i}.)</p>

<h3 id="sec:test-setup-110">Test Setup<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-setup-110" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>Ensure that the EUT and test equipment have the necessary information to send
and receive USP Records to each other.</li>
<li>Ensure the Controller used for testing has an assigned Role that is writable.</li>
</ol>

<h3 id="sec:test-steps-6">Test Steps<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-steps-6" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li><p>Send an Add message to the EUT with the following structure:</p>

<pre><code filter="pbv" type="Msg">header {
    msg_id: '&lt;msg_id&gt;'
    msg_type: ADD
}
body {
    request {
        add {
            allow_partial: false
            create_objs {
                obj_path: 'Device.LocalAgent.ControllerTrust.Role.&lt;Controller Role instance&gt;.Permission.'
                param_settings {
                        param: 'Enable'
                        value: 'true'
                    }
                param_settings {
                        param: 'Targets'
                        value: 'Device.LocalAgent.Controller.&lt;Controller instance id&gt;.PeriodicNotifInterval'
                    }
                param_settings {
                        param: 'Param'
                        value: 'rw--'
                    }
            }
        }
    }
}</code></pre></li>
<li><p>Send an Add message to the EUT with the following structure:</p>

<pre><code filter="pbv" type="Msg">header {
    msg_id: '&lt;msg_id&gt;'
    msg_type: ADD
}
body {
    request {
        add {
            allow_partial: false
            create_objs {
                obj_path: 'Device.LocalAgent.Subscription.'
                param_settings {
                        param: 'Enable'
                        value: 'true'
                    }
                param_settings {
                        param: 'NotifType'
                        value: 'ValueChange'
                    }
                param_settings {
                        param: 'ReferenceList'
                        value: 'Device.LocalAgent.Controller.&lt;Controller instance id&gt;.PeriodicNotifInterval'
                    }
            }
        }
    }
}</code></pre></li>
<li><p>Send a Set message to the EUT, setting
Device.LocalAgent.Controller.&lt;Controller instance id&gt;.PeriodicNotifInterval to a new value.</p></li>
<li><p>Wait 30 seconds.</p></li>
</ol>

<h3 id="sec:test-metrics-109">Test Metrics<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-metrics-109" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>The EUT sends an AddResponse with an <code>oper_success</code> element containing a
new Device.LocalAgent.ControllerTrust.Role.{i}.Permission. object in step 1.</li>
<li>The EUT sends an AddResponse with an <code>oper_success</code> element containing a
new Device.LocalAgent.Subscription. object in step 2.</li>
<li>The EUT sends a SetResponse with an <code>oper_success</code> element with the path
&lsquo;Device.LocalAgent.Controller.&lt;Controller instance id&gt;.PeriodicNotifInterval&rsquo;.</li>
<li>The EUT does not send a Notify message with a value_change element pointing
to &lsquo;Device.LocalAgent.Controller.&lt;Controller instance&gt;.PeriodicNotifInterval&rsquo;.</li>
</ol>

<h2 id="sec:permissions---overlapping-permissions">2.21 Permissions - Overlapping Permissions<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:permissions---overlapping-permissions" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h2>

<h3 id="sec:purpose-110">Purpose<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:purpose-110" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>The purpose of this test is to ensure the EUT allows for the creation
of Permission instances, and when Permissions overlap the EUT behaves
correctly.</p>

<h3 id="sec:functionality-tags-21">Functionality Tags<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:functionality-tags-21" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>Conditional Mandatory (supports the ControllerTrust:1 profile with at least one role that allows object creation, or supports writable parameters in Device.LocalAgent.ControllerTrust.{i}.Role.{i}.)</p>

<h3 id="sec:test-setup-111">Test Setup<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-setup-111" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>Ensure that the EUT and test equipment have the necessary information to send
and receive USP Records to each other.</li>
<li>Ensure the Controller used for testing has an assigned Role that is writable.</li>
<li>Ensure there is at least one BootParameter configured.</li>
</ol>

<h3 id="sec:test-procedure-103">Test Procedure<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-procedure-103" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li><p>Send an Add message to the EUT with the following structure:</p>

<pre><code filter="pbv" type="Msg">header {
    msg_id: '&lt;msg_id&gt;'
    msg_type: ADD
}
body {
    request {
        add {
            allow_partial: false
            create_objs {
                obj_path: 'Device.LocalAgent.ControllerTrust.&lt;Controller id&gt;.Role.Permission.'
                param_settings {
                        param: 'Enable'
                        value: 'true'
                    }
                param_settings {
                        param: 'Targets'
                        value: 'Device.LocalAgent.Controller.&lt;Controller instance id&gt;.BootParameter.&lt;boot parameter instance&gt;.'
                    }
                param_settings {
                        param: 'Param'
                        value: '----'
                    }
            }
            create_objs {
                obj_path: 'Device.LocalAgent.ControllerTrust.&lt;Controller id&gt;.Role.Permission.'
                param_settings {
                        param: 'Enable'
                        value: 'true'
                    }
                param_settings {
                        param: 'Targets'
                        value: 'Device.LocalAgent.Controller.&lt;Controller instance id&gt;.BootParameter.&lt;boot parameter instance&gt;.'
                    }
                param_settings {
                        param: 'Param'
                        value: 'rw--'
                    }
                param_settings {
                        param: 'Order'
                        value: '1'
                    }
            }
        }
    }
}</code></pre></li>
<li><p>Send a Get message to the EUT with the following structure:</p>

<pre><code filter="pbv" type="Msg">header {
    msg_id: '&lt;msg_id&gt;'
    msg_type: GET
}
body {
    request {
        get {
            param_paths: 'Device.LocalAgent.Controller.&lt;Controller instance ID&gt;.BootParameter.'
        }
    }
}</code></pre></li>
</ol>

<h3 id="sec:test-metrics-110">Test Metrics<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-metrics-110" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>The EUT sends an AddResponse message after step 1. The message contains
two <code>oper_success</code> elements, one for each added permission.</li>
<li>The EUT sends a GetResponse with a <code>result_params</code> element containing
parameters of the specified BootParameter instance.</li>
</ol>

<h2 id="sec:using-get-when-no-read-permissions-are-available-on-some-parameters">2.22 Using Get when no read permissions are available on some parameters<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:using-get-when-no-read-permissions-are-available-on-some-parameters" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h2>

<h3 id="sec:purpose-111">Purpose<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:purpose-111" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>The purpose of this test is to ensure the EUT correctly returns parameters that are readable
while ignoring parameters that do not have read permissions.</p>

<h3 id="sec:functionality-tags-22">Functionality Tags<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:functionality-tags-22" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>Conditional Mandatory (supports the ControllerTrust:1 profile with at least one role that allows object creation, or supports writable parameters in Device.LocalAgent.ControllerTrust.{i}.Role.{i}.)</p>

<h3 id="sec:test-setup-112">Test Setup<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-setup-112" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>Ensure that the EUT and test equipment have the necessary information to send
and receive USP Records to each other.</li>
<li>Ensure the Controller used for testing has an assigned Role that is writable.</li>
<li>Ensure there is at least one BootParameter configured.</li>
</ol>

<h3 id="sec:test-procedure-104">Test Procedure<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-procedure-104" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li><p>Send an Add message to the EUT with the following structure:</p>

<pre><code filter="pbv" type="Msg">header {
    msg_id: '&lt;msg_id&gt;'
    msg_type: ADD
}
body {
    request {
        add {
            allow_partial: false
            create_objs {
                    obj_path: 'Device.LocalAgent.ControllerTrust.Role.&lt;Controller trust instance&gt;.Permission.'
                    param_settings {
                            param: 'Enable'
                            value: 'true'
                        }
                    param_settings {
                            param: 'Targets'
                            value: 'Device.LocalAgent.Controller.&lt;Controller instance ID&gt;.BootParameter.&lt;known instance&gt;.ParameterName'
                        }
                    param_settings {
                            param: 'Param'
                            value: '----'
                        }
                }
        }
    }
}</code></pre></li>
<li><p>Send a Get message to the EUT with the following structure:</p>

<pre><code filter="pbv" type="Msg">header {
    msg_id: '&lt;msg_id&gt;'
    msg_type: GET
}
body {
    request {
        get {
            param_paths: 'Device.LocalAgent.Controller.&lt;Controller instance ID&gt;.BootParameter.&lt;known instance&gt;.'
        }
    }
}</code></pre></li>
</ol>

<h3 id="sec:test-metrics-111">Test Metrics<a class="headerlink" href="03-index-authentication-and-access-control-test-cases.html#sec:test-metrics-111" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<ol>
<li>The EUT sends an AddResponse message after step 1. The message contains
a <code>oper_success</code> element for the added Permission.</li>
<li>The EUT sends a GetResponse with a <code>result_params</code> element containing
parameters of the specified BootParameter instance, with the exception
of the &lsquo;ParameterName&rsquo; parameter.</li>
</ol>

